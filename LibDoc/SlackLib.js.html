<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: SlackLib.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: SlackLib.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * Creates a generic slack message section.
 *
 * @param {string} text text for the section
 * @return {object}
 */
function createSection(text) {
  return {
			"type": "section",
			"text": {
				"type": "mrkdwn",
				"text": `${text}`
			}
	};
}

/**
 * Creates a field in a body section for slack message.
 * 
 * @param {string} text text for the field
 * @return {object}
 */
function createField(text) {
  return {
    "type": "mrkdwn",
    "text": `${text}`
  };
}

/**
 * Creates job body for an opportunity to 
 * be added to the slack message block.
 * 
 * @param {object[]} sections message body sections
 * @return {object} 
 */
function createBodySection(sections) {
  return {
			"type": "section",
			"fields": sections
	};
}

/**
 * Creates a slack message section divider
 * 
 * @return {object}
 */
function createSectionDivider() {
  return {"type": "divider"};
}

/**
 * Creates slack message block that message
 * sections can be added to.
 * 
 * @return {object}
 */
function createSlackMessageBlock() {
  return JSON.parse('{"blocks": []}');
}

/**
 * Add one or more sections to a slack message block
 * 
 * @param {object} messageBlock JSON slack message block
 * @param {object[]} sections Array of JSON slack sections
 * @return {object}
 */
function addSectionsToSlackMessageBlock(messageBlock, sections) {
  for (var i = 0; i &lt; sections.length; i++) {
    messageBlock["blocks"].push(sections[i]);
  }

  return messageBlock;
}

/**
 * Post message to slack
 * 
 * @param {string} webhookURL webhook URL for slack
 * @param {object} messageBlocks slack message JSON object
 * @return {undefined}
 */
function postToSlack(webhookURL, messageBlocks) {
  var payload = {
    blocks: messageBlocks["blocks"]
  };
 
  var options = {
    "method" : "post",
    "contentType" : "application/json",
    "payload" : JSON.stringify(payload)
  };
 
  UrlFetchApp.fetch(webhookURL, options);
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#addSectionsToSlackMessageBlock">addSectionsToSlackMessageBlock</a></li><li><a href="global.html#createBodySection">createBodySection</a></li><li><a href="global.html#createField">createField</a></li><li><a href="global.html#createSection">createSection</a></li><li><a href="global.html#createSectionDivider">createSectionDivider</a></li><li><a href="global.html#createSlackMessageBlock">createSlackMessageBlock</a></li><li><a href="global.html#filterByDate">filterByDate</a></li><li><a href="global.html#getEndDate">getEndDate</a></li><li><a href="global.html#getSheetData">getSheetData</a></li><li><a href="global.html#getStartDate">getStartDate</a></li><li><a href="global.html#postToSlack">postToSlack</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.7</a> on Thu Jun 17 2021 20:43:33 GMT+0100 (British Summer Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
